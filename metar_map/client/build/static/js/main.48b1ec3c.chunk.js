(this.webpackJsonpmetar_map=this.webpackJsonpmetar_map||[]).push([[0],{13:function(t,e,a){},14:function(t,e,a){},15:function(t,e,a){"use strict";a.r(e);var r=a(0),n=a.n(r),s=a(7),i=a.n(s),o=(a(13),a(1)),c=a(2),l=a(4),p=a(3),u=a(5);a(14);var m=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(p.a)(e).call(this,t))).ws=new WebSocket("ws://localhost:4567/metar.ws"),a.airportsPerRow=7,a.cycleDelay=1e4,a.firstMessage=!0,a.updateSelectedAirport=function(t){a.setState({selectedAirport:t})},a.cycleAirports=function(){var t=a.state.currentIndex>=a.state.metars.length-1?0:a.state.currentIndex+1;a.setState({currentIndex:t}),a.updateSelectedAirport(a.state.metars[a.state.currentIndex]),setTimeout(a.cycleAirports,a.cycleDelay)},a.state={airports:{},metars:[],metarCount:0,selectedAirport:null,airportComponents:[],currentIndex:0,lastUpdated:0},a}return Object(u.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.ws.onopen=function(){console.log("Connected")},this.ws.onmessage=function(e){var a=JSON.parse(e.data);"metar"===a.type?(console.log("RX metar message"),console.log(a.payload.metars.airports.length),t.setState({airports:a.payload,metars:a.payload.metars.airports,metarCount:a.payload.metars.airports.length,lastUpdated:a.payload.metars.lastUpdated}),t.firstMessage&&(t.firstMessage=!1,t.setState({selectedAirport:a.payload.metars.airports[0]}))):console.log("Unknown message: "+JSON.stringify(a))},this.cycleAirports()}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(d,{metars:this.state.metars,airportRows:this.state.metarCount/this.airportsPerRow,airportsPerRow:this.airportsPerRow,updateSelectedAirport:this.updateSelectedAirport}),n.a.createElement(v,{last_updated:new Date(this.state.lastUpdated)}),n.a.createElement(y,{selectedAirport:this.state.selectedAirport,airports:this.state.airports}))}}]),e}(n.a.Component),d=function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"flightCategoryToCSS",value:function(t){return"VFR"===t?"is-success":"MVFR"===t?"is-info":"IFR"===t?"is-danger":"unknown-"+t}},{key:"render",value:function(){for(var t=[],e=0;e<this.props.metars.length;e++){var a=this.props.metars[e],r=Object.values(a.station_id),s=a.flight_category?this.flightCategoryToCSS(a.flight_category._text):"unknown-category",i=Object.values(a.raw_text),o=n.a.createElement(f,{key:r,id:r,flight_category:s,raw_text:i,updateSelectedAirport:this.props.updateSelectedAirport,metar:a});t.push(o)}for(var c=[],l=0;l<this.props.airportRows;l++){var p=l*this.props.airportsPerRow,u=p+this.props.airportsPerRow;c.push(t.slice(p,u))}return c.map((function(t,e){return n.a.createElement(h,{key:e},t)}))}}]),e}(n.a.Component),h=function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return n.a.createElement("div",{className:"tile is-ancestor"},this.props.children)}}]),e}(n.a.Component),f=function(t){function e(){var t,a;Object(o.a)(this,e);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=Object(l.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(n)))).sendAirportData=function(){a.props.updateSelectedAirport(a.props.metar)},a}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return n.a.createElement("div",{className:"tile is-parent has-text-centered",onClick:this.sendAirportData},n.a.createElement("article",{className:"tile is-child box notification ".concat(this.props.flight_category),style:{padding:"0 5px 5px 0"}},n.a.createElement("p",{className:"title is-4 has-text-centered",style:{marginBottom:"5px"}}," ",this.props.id," "),n.a.createElement(g,{metar:this.props.metar})))}}]),e}(n.a.Component),g=function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=[],e=Date.now();return this.props.metar.wind_speed_kt&&this.props.metar.wind_speed_kt._text>20&&t.push(n.a.createElement("i",{key:e,className:"fas fa-exclamation-triangle"})),this.props.metar.wind_gust_kt&&this.props.metar.wind_gust_kt._text>20&&t.push(n.a.createElement("i",{key:e+1,className:"fas fa-exclamation-triangle"})),this.props.metar.wind_gust_kt&&this.props.metar.wind_gust_kt._text>30&&t.push(n.a.createElement("i",{key:e+2,className:"fas fa-exclamation-triangle"})),n.a.createElement("p",{id:this.props.metar.station_id,className:"icon is-small has-text-warning"},t)}}]),e}(n.a.Component),y=function(t){function e(){return Object(o.a)(this,e),Object(l.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=null,e=[];if(this.props.selectedAirport){var a=this.props.selectedAirport.station_id._text;t=this.props.selectedAirport.raw_text._text;var r=this.props.airports[a].taf;r&&(e=r.raw_text._text)}else t="";return n.a.createElement("div",null,n.a.createElement("pre",null,t,n.a.createElement("p",null,e)))}}]),e}(n.a.Component),v=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(l.a)(this,Object(p.a)(e).call(this,t))).metarAgeTime=function(){var t=Math.floor((a.state.currentTime-a.props.last_updated)/1e3);return Math.floor(t/60)+":"+Math.floor(t%60).toString().padStart(2,"0")},a.state={currentTime:(new Date).toLocaleString()},a}return Object(u.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this;setInterval((function(){t.setState({currentTime:new Date})}),1e3)}},{key:"render",value:function(){return n.a.createElement("div",{className:"tile is-ancenstor"},n.a.createElement("div",{className:"tile is-parent is-12 has-text-grey-lighter",style:{marginTop:"0px",paddingTop:"0px"}},n.a.createElement("div",{className:"tile is-child"},n.a.createElement("div",{className:"is-pulled-right"},this.metarAgeTime()," old"))))}}]),e}(n.a.Component),b=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(m,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},8:function(t,e,a){t.exports=a(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.48b1ec3c.chunk.js.map